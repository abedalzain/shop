<!--
  Generated template for the DeliveryPage page.

  See http://ionicframework.com/docs/components/#navigation for more info on
  Ionic pages and navigation.
-->
<ion-header>

  <ion-navbar>
    <ion-title text-center><h1>Delivery</h1></ion-title>
    <ion-fab class="basketicon" top right edge>
    <button ion-fab class="trans-fab-btn" (click)=" goToSettings()">
       
      <ion-icon name="md-person"></ion-icon>
    </button>
  </ion-fab>
  </ion-navbar>

</ion-header>


<ion-content padding>
  
  <ion-row class=" orderPage" >
      <!-- <ion-row col-12 *ngIf="showForm">
        <ion-col text-right>
          <button ion-button color="secondary" (click)="toggleForm()">
            Add New Delvery Address
          </button>
        </ion-col>
      </ion-row> -->
    <ion-list class="shopbox" col-12 >
          <ion-row col-12 *ngIf="!showForm">
        <!-- <ion-col text-left>
          <button ion-button icon-left color="secondary" (click)="back()">
            <ion-icon name="ios-arrow-back-outline"></ion-icon>
            Back
          </button>
        </ion-col> -->
        <ion-col text-center>
          <button ion-button color="secondary" *ngIf="db.User.me" (click)="toggleForm()">
            Use existing delivery address
          </button>
        </ion-col>
      </ion-row>
        <div col-12>
          <ion-label color="dark">Delivery dates</ion-label>
          <ion-item no-margin no-padding>
            <ion-datetime item-start col-10 col-sm-6 class="deliver-date-box"  placeholder="Choose a delivery date " displayFormat="MM/DD/YYYY" [(ngModel)]="deleverDate"></ion-datetime> 
          </ion-item>
          
        </div>
        
        <div col-12 *ngIf="showForm">
        <ion-label color="dark">Delivery address</ion-label>
          <ion-list radio-group class="delmarg">
            <ion-item *ngIf="userAddrss">
              <ion-label>
                {{userAddrss?.Address_1}}&nbsp;{{userAddrss?.Address_2}}&nbsp;{{userAddrss?.Address_3}}&nbsp;{{userAddrss?.Address_4}}&nbsp;{{userAddrss?.County}}&nbsp;{{userAddrss?.Postcode}}&nbsp;{{userAddrss?.Country}}
              </ion-label>
              <ion-radio [checked]="userAddrss != null" (ionSelect)="selectDefaultAddress()"></ion-radio>
            </ion-item>
            <ion-item *ngFor="let delAddress of prevDeliveryAddresses; let i = index;">
              <ion-label>
                {{delAddress?.Address_1}}&nbsp;{{delAddress?.Address_2}}&nbsp;{{delAddress?.Address_3}}&nbsp;{{delAddress?.Address_4}}&nbsp;{{delAddress?.County}}&nbsp;{{delAddress?.Postcode}}&nbsp;{{delAddress?.Country}}
              </ion-label>
              <ion-radio (ionSelect)="selectDelAddress(i)" ></ion-radio>
            </ion-item>
            <ion-item >
              <ion-label>
                Enter Different Address
              </ion-label>
              <ion-radio (ionSelect)="toggleForm()" ></ion-radio>
            </ion-item>
            
            <ion-row col-12>
              <ion-col col-12 text-right>
                <button ion-button icon-right color="secondary" (click)="continue()" [disabled]="!selectedDeliveryAddressId">
                  Continue
                  <ion-icon name="ios-arrow-forward-outline"></ion-icon>
                </button>
              </ion-col>
            </ion-row>
          </ion-list>
          <!-- <ion-item no-padding col-12 [class.border-top]="i>0 && i<prevDeliveryAddresses?.length"  *ngFor="let delAddress of prevDeliveryAddresses; let i = index;">
            <ion-row col-12 *ngIf="delAddress.Address_1?.length > 0">
              <ion-col>
                Address 1 : {{delAddress.Address_1 }}
              </ion-col>
            </ion-row>
            <ion-row col-12 *ngIf="delAddress.Address_2?.length > 0">
              <ion-col>
                Address 2 : {{delAddress.Address_2}}
              </ion-col>
            </ion-row>
            <ion-row col-12 *ngIf="delAddress.Address_3?.length > 0">
              <ion-col>
                Address 3 : {{delAddress.Address_3}}
              </ion-col>
            </ion-row>
            <ion-row col-12 *ngIf="delAddress.Address_4?.length > 0">
              <ion-col>
                Address 4 : {{delAddress.Address_4}}
              </ion-col>
            </ion-row>
            <ion-row col-12 *ngIf="delAddress.County?.length > 0">
              <ion-col>
                County : {{delAddress.County}}
              </ion-col>
            </ion-row>
            <ion-row col-12 *ngIf="delAddress.County?.length > 0">
              <ion-col>
                Postcode : {{delAddress.Postcode}}
              </ion-col>
            </ion-row>
            <ion-row col-12  *ngIf="delAddress.County?.length > 0">
              <ion-col>
                Country : {{delAddress.Country}}
              </ion-col>
            </ion-row>
            <ion-row col-12>
              <ion-col col-12 text-right>
                <button text-wrap ion-button color="secondary" (click)="selectAndContinue(delAddress.key)" >
                  Select This Address And Continue
                </button>
              </ion-col>
            </ion-row>
          </ion-item> -->

          <!-- <ion-select interface="popover" [(ngModel)]="delAddress">
            <ion-option  *ngFor="let delAddress of prevDeliveryAddresses" [value]="delAddress.key" (ionSelect)="selectedDelivAddress(delAddress.key)">
              {{delAddress.Address_1 }} , {{delAddress.Address_2}} , {{delAddress.Address_3}} , {{delAddress.Address_4}} ,{{delAddress.County}} , {{delAddress.Country}}
            </ion-option>
            <ion-option (ionSelect)="emptyAddress()">New Delivery Address</ion-option>
            <ion-option value="3">Address 3 </ion-option>
            <ion-option value="4">Address 4 </ion-option>
          </ion-select> -->
        </div>
        <form [formGroup]="contactForm" *ngIf="!showForm && !db.User.me">
          <ion-row no-padding no-margin >
            <ion-label>
              Contact Name :
            </ion-label>
            <ion-item class="form-item">
              <ion-input type="text" placeholder="First Name" formControlName="fName" ></ion-input>
            </ion-item>
            <ion-item class="form-item">
              <ion-input type="text" placeholder="Last Name" formControlName="lName" ></ion-input>
            </ion-item>
          </ion-row>

          <ion-row no-padding no-margin *ngIf="!showForm">
            <ion-label>
              Email For Order Confirmation :
            </ion-label>
            <ion-item class="form-item">
              <ion-input type="text" placeholder="Email Address" formControlName="email" ></ion-input>
            </ion-item>
          </ion-row>

          <ion-row no-padding no-margin *ngIf="!showForm">
            <ion-label>
              Phone For Delivery Queries
            </ion-label>
            <ion-item class="form-item">
              <ion-input type="text" maxlength="11" minlength="10" placeholder="Mobile Number" formControlName="phone" ></ion-input>
            </ion-item>
          </ion-row>
        </form>
        <ion-row no-padding no-margin *ngIf="!showForm">
          <ion-label>
            Delivery Address
          </ion-label>

          <ion-item class="form-item">
            <ion-input type="text" placeholder="Address Line 1 " [(ngModel)]="deleveryAddress.line1" ></ion-input>
          </ion-item>

          <ion-item class="form-item">
            <ion-input type="text" placeholder="Address Line 2 " [(ngModel)]="deleveryAddress.line2"></ion-input>
          </ion-item>

          <ion-item class="form-item">
            <ion-input type="text" placeholder="Address Line 3 " [(ngModel)]="deleveryAddress.line3"></ion-input>
          </ion-item>

          <ion-item class="form-item">
            <ion-input type="text" placeholder="Address Line 4 " [(ngModel)]="deleveryAddress.line4"></ion-input>
          </ion-item>
          
          <ion-item class="form-item">
            <ion-input type="text" placeholder="County" [(ngModel)]="deleveryAddress.county"></ion-input>
          </ion-item>

          <ion-item class="form-item">
            <ion-input type="text" placeholder="Post Code" pattern="^([Gg][Ii][Rr] 0[Aa]{2})|((([A-Za-z][0-9]{1,2})|(([A-Za-z][A-Ha-hJ-Yj-y][0-9]{1,2})|(([A-Za-z][0-9][A-Za-z])|([A-Za-z][A-Ha-hJ-Yj-y][0-9]?[A-Za-z])))) [0-9][A-Za-z]{2})$" [(ngModel)]="deleveryAddress.postCode" ></ion-input>
          </ion-item>

          <ion-item class="form-item">
            <ion-input type="text" placeholder="UK" readonly [(ngModel)]="deleveryAddress.country" ></ion-input>
          </ion-item>
          <ion-row  class="payment-row-input" col-12>
            <!-- <ion-col text-left>
              <button ion-button icon-left color="secondary" (click)="back()">
                <ion-icon name="ios-arrow-back-outline"></ion-icon>
                Back
              </button>
            </ion-col> -->
            <ion-col text-right>
              <button ion-button icon-right color="secondary" (click)="continue()" *ngIf="contactForm" [disabled]="!contactForm.valid || !checkDeliverAddressNotEmpty()">
                Continue
                <ion-icon name="ios-arrow-forward-outline"></ion-icon>
              </button>
              <button ion-button icon-right color="secondary" (click)="continue()" *ngIf="!contactForm" [disabled]="!checkDeliverAddressNotEmpty()">
                Continue
                <ion-icon name="ios-arrow-forward-outline"></ion-icon>
              </button>
            </ion-col>
          </ion-row>
        </ion-row>
    </ion-list>
  </ion-row>
</ion-content>
